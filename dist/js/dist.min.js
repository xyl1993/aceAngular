/*! static-work 2017-03-24 */
var mainModule=angular.module("mainModule",["ui.router","ngResource","ngSanitize"]);mainModule.run(["$rootScope","$state","$http","$stateParams","$location","$timeout","$window",function(a,b,c,d,e,f,g){}]),mainModule.config(["$stateProvider","$urlRouterProvider","$compileProvider",function(a,b,c){a.state("index",{url:"/index",templateUrl:"src/tmp/index.html"}),c.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|sms):/),b.otherwise("/index")}]),mainModule.controller("indexCtrl",["$scope","$rootScope","$state","indexServ",function(a,b,c,d){d.loadMenu().then(function(b){a.menuDatas=b.data.data}),a.loginOut=function(){location.href="login.html"}}]),mainModule.directive("versionManageDialog",[function(){return{restrict:"AE",link:function(a,b,c){},templateUrl:"src/tmp/appControl/dialog/versionManageDialog.html"}}]).directive("announceManageDialog",[function(){return{restrict:"AE",link:function(a,b,c){},templateUrl:"src/tmp/appControl/dialog/announceManageDialog.html"}}]),mainModule.directive("equelframe",[function(){return{restrict:"AE",link:function(a,b,c){a.getContentUrl=function(){return $(b).parent().data("src")}},template:'<div ng-include="getContentUrl()"></div>'}}]).directive("tabContentDirective",[function(){return{restrict:"AE",scope:!0,link:function(a,b,c){},templateUrl:function(a,b){return b.url}}}]).directive("topTagClose",[function(){return{restrict:"AE",scope:!0,templateUrl:"src/tmp/baseTmp/topTagClose.html",link:function(a,b,c){var d=c.flag;"home"==d?($("#closeThis").addClass("menu-disabled"),$("#closeThis").click(function(a){return!1})):$("#closeThis").click(function(a){$("#"+d).remove(),$(this).closest(".top-menu-list").remove();var b=$("#menu").children(".top-menu-list:last-child"),c=b.data("category");0==$("#menu").children(".top-menu-list.active").length&&(b.addClass("active"),$("#"+c).show())}),$("#closeOther").click(function(){$("#"+d).siblings(".not-main-tab").remove(),$(this).closest(".top-menu-list").siblings(".not-main-tab").remove(),$(this).closest(".top-menu-list").addClass("active"),$("#"+d).show()}),$(":not(.top-tag-ul *)").click(function(){$("#closeTag").remove()})}}}]).directive("mainDirective",[function(){return{restrict:"AE",scope:!0,link:function(a,b,c){},templateUrl:"src/tmp/main.html"}}]).directive("topMenu",["$compile",function(a){return{restrict:"AE",link:function(b,c,d){$(c).click(function(){var a=$(c).data("category");$("#"+a).show(),$("#"+a).siblings().hide()}),$(c)[0].oncontextmenu=function(){$("#closeTag").remove();var c='<top-tag-close id="closeTag" data-flag='+$(this).data("category")+"></top-tag-close>";return $(this).append(a(c)(b)),!1}}}}]).directive("closeTopTab",[function(){return{restrict:"AE",link:function(a,b,c){$(b).click(function(){var a=$(this).data("category");if($("#"+a).remove(),$(this).closest("li").remove(),0==$("#menu").children("li.active").length){var b=$("#menu").children("li:last-child");b.addClass("active");var c=b.data("category");$("#"+c).show()}})}}}]).directive("leftMenu",["$compile",function(a){return{restrict:"AE",link:function(b,c,d){$(c).click(function(){var d=$("#menu").width(),e=0,f=$(this).data("name"),g=$(this).data("type"),h=$(this).data("url"),i=$(".top-menu-list");if($(".top-menu-list").removeClass("active"),$(".child-content").hide(),0!=$("[data-category="+g+"]").length)$("li[data-category="+g+"]").addClass("active"),$("div[data-category="+g+"]").show();else{for(var j=0,k=i.length;j<k;j++)e+=$(i[j]).width();if(e+130>d)return void bootbox.alert("不能在添加啦");var l='<li class="active top-menu-list not-main-tab" data-category = "'+g+'" top-menu ><a data-toggle="tab">'+f+'<span class="icon-remove" data-category = "'+g+'" close-top-tab></span></a></li>',m="<div data-category = '"+g+"' id='"+g+"' class='child-content not-main-tab'><tab-content-directive url="+h+"></tab-content-directive></div>",n=a(l)(b),o=a(m)(b);$("#menu").append(n),$("#content-dyn").append(o)}$(".left-tab-menu").removeClass("active"),$(c).addClass("active")})}}}]).directive("bootstrapTabClick",[function(){return{restrict:"AE",link:function(a,b,c){$(b).click(function(){var a=$(this).data("href");$(a).show(),$(a).siblings().hide()})}}}]),mainModule.directive("roleDialog",[function(){return{restrict:"AE",link:function(a,b,c){},templateUrl:"src/tmp/sysControl/dialog/roleDialog.html"}}]).directive("addSysuserDialog",[function(){return{restrict:"AE",link:function(a,b,c){},templateUrl:"src/tmp/sysControl/dialog/addSysUserDialog.html"}}]).directive("addMenuDialog",[function(){return{restrict:"AE",link:function(a,b,c){},templateUrl:"src/tmp/sysControl/dialog/addMenuDialog.html"}}]).directive("bankCardDialog",[function(){return{restrict:"AE",link:function(a,b,c){},templateUrl:"src/tmp/sysControl/dialog/bankCardDialog.html"}}]),mainModule.factory("appServ",["$http",function(a){return{getVersionDatas:function(){return a({method:"get",url:"src/data/role.json"})},getAnnounceDatas:function(){return a({method:"get",url:"src/data/role.json"})}}}]),mainModule.factory("indexServ",["$http",function(a){return{loadMenu:function(){return a({method:"get",url:"src/data/menu.json"})}}}]),mainModule.factory("sysServ",["$http",function(a){return{getRole:function(){return a({method:"get",url:"src/data/role.json"})},getSysUser:function(){return a({method:"get",url:"src/data/sysUser.json"})},getBankCard:function(){return a({method:"get",url:"src/data/bankCardAudit.json"})}}}]),mainModule.controller("announceManageCtrl",["$scope","$rootScope","$state","appServ",function(a,b,c,d){a.userModel={},a.selectAll=function(a){a.target.checked?$(".announceManageCheckd").prop("checked","true"):$(".announceManageCheckd").removeAttr("checked")},a.select=function(a){var b=a.target,c=!0,d=$(".announceManageCheckd");if(b.checked){for(var e=0,f=d.length;e<f;e++)if(!$(d[e]).is(":checked"))return void(c=!1);c&&$("#announceManageSelectAll").prop("checked","true")}else $("#announceManageSelectAll").removeAttr("checked")},a.saveUser=function(){console.log(a.userModel)},d.getAnnounceDatas().then(function(b){200==b.data.code&&(a.lists=b.data.data)}),a.add=function(){$("#announceManageDialog").modal({keyboard:!1})},a.edit=function(b){a.userModel=b,$("#announceManageDialog").modal({keyboard:!1})},a.del=function(){bootbox.confirm("确认删除么?",function(a){})},a.startAll=function(){0!=$(".announceManageCheckd:checked").length?bootbox.confirm("确认启用么?",function(a){}):bootbox.alert("请先选择数据")},a.stopAll=function(){0!=$(".announceManageCheckd:checked").length?bootbox.confirm("确认禁用么?",function(a){}):bootbox.alert("请先选择数据")},a.start=function(){bootbox.confirm("确认启用么?",function(a){})},a.stop=function(){bootbox.confirm("确认禁用么?",function(a){})}}]),mainModule.controller("versionManageCtrl",["$scope","$rootScope","$state","appServ",function(a,b,c,d){a.userModel={},a.selectAll=function(a){a.target.checked?$(".versionManageCheckd").prop("checked","true"):$(".versionManageCheckd").removeAttr("checked")},a.select=function(a){var b=a.target,c=!0,d=$(".versionManageCheckd");if(b.checked){for(var e=0,f=d.length;e<f;e++)if(!$(d[e]).is(":checked"))return void(c=!1);c&&$("#versionManageSelectAll").prop("checked","true")}else $("#versionManageSelectAll").removeAttr("checked")},a.saveUser=function(){console.log(a.userModel)},d.getVersionDatas().then(function(b){200==b.data.code&&(a.lists=b.data.data)}),a.add=function(){$("#versionManageDialog").modal({keyboard:!1})},a.edit=function(b){a.userModel=b,$("#sysUserDialog").modal({keyboard:!1})},a.del=function(){bootbox.confirm("确认删除么?",function(a){})},a.startAll=function(){0!=$(".versionManageCheckd:checked").length?bootbox.confirm("确认启用么?",function(a){}):bootbox.alert("请先选择数据")},a.stopAll=function(){0!=$(".versionManageCheckd:checked").length?bootbox.confirm("确认禁用么?",function(a){}):bootbox.alert("请先选择数据")},a.start=function(){bootbox.confirm("确认启用么?",function(a){})},a.stop=function(){bootbox.confirm("确认禁用么?",function(a){})}}]),mainModule.controller("authorizationGroupCtrl",["$scope","$rootScope","$state","sysServ",function(a,b,c,d){function e(){var a=$("#permitTree").jstree("get_checked");console.log(a)}a.delClick=function(){bootbox.confirm("Are you sure?",function(a){})},a.add=function(){$("#roleDialg").modal({keyboard:!1})},d.getRole().then(function(a){if(200==a.data.code){var b=a.data.data;b[0].state={opened:!0},$("#permitTree").jstree({checkbox:{keep_selected_style:!1},plugins:["checkbox"],core:{themes:{responsive:!1},data:b},types:{default:{icon:"fa fa-folder icon-state-warning icon-lg"},file:{icon:"fa fa-file icon-state-warning icon-lg"}}})}}),a.save=function(){e()}}]),mainModule.controller("bankCardAuditCtrl",["$scope","$rootScope","$state","sysServ",function(a,b,c,d){function e(c){var d="alarm/getAlarmData/paging/"+c+"/"+pageSize;$http({method:"post",url:d,data:a.searchData,headers:{token:b.token}}).success(function(b){if(0==b.code){a.resDatas=b.data,a.sysRole=b.role;b.data.recordCount;f(b.data.pageCount>0?b.data.pageCount:1)}})}function f(a){g.twbsPagination({totalPages:a,visiblePages:5,first:"首页",prev:"上一页",next:"下一页",last:"末页",onPageClick:function(a,b){e(b)}})}a.dialogModel={};var g=$("#bankCardPagination");f(1),a.selectAll=function(a){a.target.checked?$(".bankCardCheckd").prop("checked","true"):$(".bankCardCheckd").removeAttr("checked")},a.select=function(a){var b=a.target,c=!0,d=$(".sysUserCheckd");if(b.checked){for(var e=0,f=d.length;e<f;e++)if(!$(d[e]).is(":checked"))return void(c=!1);c&&$("#bankCardSelectAll").prop("checked","true")}else $("#bankCardSelectAll").removeAttr("checked")},d.getBankCard().then(function(b){200==b.data.code&&(a.lists=b.data.data)});var h={reposition:!0,scalePhotos:!0,scrolling:!1,previous:'<i class="icon-arrow-left"></i>',next:'<i class="icon-arrow-right"></i>',close:"&times;",current:"{current} of {total}",maxWidth:"100%",maxHeight:"100%",onOpen:function(){document.body.style.overflow="hidden"},onClosed:function(){document.body.style.overflow="auto"},onComplete:function(){$.colorbox.resize()}};a.doAction=function(b,c){a.dialogModel=b,1==c?(a.lookType=1,$("#dialogCheckReason").prop("readonly","true")):(a.lookType=2,$("#dialogCheckReason").removeAttr("readonly")),$("#bankCardDialog").modal({keyboard:!1}).on("shown.bs.modal",function(a){$('.ace-thumbnails [data-rel="colorbox"]').colorbox(h),$("#cboxLoadingGraphic").append("<i class='icon-spinner orange'></i>")})},a.startAll=function(){0!=$(".sysUserCheckd:checked").length?bootbox.confirm("确认通过么?",function(a){}):bootbox.alert("请先选择数据")}}]),mainModule.controller("menuMainCtrl",["$scope","$rootScope","$state","sysServ",function(a,b,c,d){function e(c){var d="alarm/getAlarmData/paging/"+c+"/"+pageSize;$http({method:"post",url:d,data:a.searchData,headers:{token:b.token}}).success(function(b){if(0==b.code){a.resDatas=b.data,a.sysRole=b.role;b.data.recordCount;f(b.data.pageCount>0?b.data.pageCount:1)}})}function f(a){g.twbsPagination({totalPages:a,visiblePages:5,first:"首页",prev:"上一页",next:"下一页",last:"末页",onPageClick:function(a,b){e(b)}})}a.menuModel={},a.menuGradeList=[{value:1,name:"一级菜单"},{value:2,name:"二级菜单"}];var g=$("#menuPagination");f(1),a.selectAll=function(a){a.target.checked?$(".sysUserCheckd").prop("checked","true"):$(".sysUserCheckd").removeAttr("checked")},a.select=function(a){var b=a.target,c=!0,d=$(".sysUserCheckd");if(b.checked){for(var e=0,f=d.length;e<f;e++)if(!$(d[e]).is(":checked"))return void(c=!1);c&&$("#sysUserSelectAll").prop("checked","true")}else $("#sysUserSelectAll").removeAttr("checked")},a.saveUser=function(){console.log(a.menuModel)},d.getSysUser().then(function(b){200==b.data.code&&(a.lists=b.data.data)}),a.add=function(){$("#addMenuDialog").modal({keyboard:!1}).on("shown.bs.modal",function(c){$("#addMenuForm").validate({errorElement:"div",errorClass:"help-block",focusInvalid:!1,debug:!0,rules:{menuName:{required:!0},menuGrade:{required:!0},menuFather:{required:!0},menuUrl:{required:!0}},messages:{menuName:{required:"菜单名称不能为空"},menuGrade:{required:"菜单等级不能为空"},menuFather:{required:"上级菜单不能为空"},menuUrl:{required:"菜单路径不能为空"}},highlight:function(a){$(a).closest(".form-group").removeClass("has-info").addClass("has-error")},submitHandler:function(c){$http({method:"post",url:"alarm/saveAllocation",data:{id:a.allocationD.id,refuseUserId:a.allocationD.refuseUserId},headers:{token:b.token}}).success(function(b){0==b.code&&($("#allocationModal").modal("hide"),a.allocationData=b.data,g.empty(),g.removeData("twbs-pagination"),g.unbind("page"),e(1))})}})})},a.edit=function(b){a.menuModel=b,$("#addMenuDialog").modal({keyboard:!1})},a.del=function(){bootbox.confirm("确认删除么?",function(a){})},a.startAll=function(){0!=$(".sysUserCheckd:checked").length?bootbox.confirm("确认启用么?",function(a){}):bootbox.alert("请先选择数据")},a.stopAll=function(){0!=$(".sysUserCheckd:checked").length?bootbox.confirm("确认禁用么?",function(a){}):bootbox.alert("请先选择数据")},a.start=function(){bootbox.confirm("确认启用么?",function(a){})},a.stop=function(){bootbox.confirm("确认禁用么?",function(a){})}}]),mainModule.controller("sysUserCtrl",["$scope","$rootScope","$state","sysServ",function(a,b,c,d){a.userModel={},a.selectAll=function(a){a.target.checked?$(".sysUserCheckd").prop("checked","true"):$(".sysUserCheckd").removeAttr("checked")},a.select=function(a){var b=a.target,c=!0,d=$(".sysUserCheckd");if(b.checked){for(var e=0,f=d.length;e<f;e++)if(!$(d[e]).is(":checked"))return void(c=!1);c&&$("#sysUserSelectAll").prop("checked","true")}else $("#sysUserSelectAll").removeAttr("checked")},a.saveUser=function(){console.log(a.userModel)},d.getSysUser().then(function(b){200==b.data.code&&(a.lists=b.data.data)}),a.add=function(){$("#sysUserDialog").modal({keyboard:!1})},a.edit=function(b){a.userModel=b,$("#sysUserDialog").modal({keyboard:!1})},a.del=function(){bootbox.confirm("确认删除么?",function(a){})},a.startAll=function(){0!=$(".sysUserCheckd:checked").length?bootbox.confirm("确认启用么?",function(a){}):bootbox.alert("请先选择数据")},a.stopAll=function(){0!=$(".sysUserCheckd:checked").length?bootbox.confirm("确认禁用么?",function(a){}):bootbox.alert("请先选择数据")},a.start=function(){bootbox.confirm("确认启用么?",function(a){})},a.stop=function(){bootbox.confirm("确认禁用么?",function(a){})}}]);